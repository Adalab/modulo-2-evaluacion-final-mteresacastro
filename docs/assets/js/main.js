"use strict";const inputText=document.querySelector(".js-searchText"),btnSearch=document.querySelector(".js-searchBtn"),notFound=document.querySelector(".js-notFound"),ulFavourites=document.querySelector(".js-favouriteList"),principalList=document.querySelector(".js-principalList"),btnDeleteAll=document.querySelector(".js-deleteAll");let seriesList=[],seriesFavourites=[],storedFavourites=[];function renderSerie(e){const t=document.createElement("div");t.setAttribute("class","serieBox js-serieBox"),t.dataset.idElement=e.show.id;const s=seriesFavourites.find(t=>t.show.id===e.show.id);console.log(seriesFavourites),void 0!==s&&t.classList.add("selected");const r=document.createElement("img");r.setAttribute("class","serieBox__img js-serieBox__img"),r.setAttribute("alt",e.show.name),imageSrc(e,r),t.appendChild(r);const i=document.createElement("p");i.setAttribute("class","serieBox__title js-serieBox__title");const o=document.createTextNode(e.show.name);return i.appendChild(o),t.appendChild(i),t.addEventListener("click",handleClickFavourites),t}function renderSerieList(e){principalList.innerHTML="";for(const t of e){const e=renderSerie(t);principalList.appendChild(e)}}function renderFavouriteSerie(e){const t=document.createElement("li");t.setAttribute("class","serieFavouriteBox js-serieFavouriteBox");const s=document.createElement("img");s.setAttribute("class","serieFavouriteBox__img js-serieFavouriteBox__img"),s.setAttribute("alt",e.show.name),imageSrc(e,s),t.appendChild(s);const r=document.createElement("i");r.setAttribute("class","fa-solid fa-trash removeFav js-removeFav"),r.setAttribute("data-id",e.show.id),t.appendChild(r);const i=document.createElement("p");i.setAttribute("class","serieFavouriteBox__title js-serieFavouriteBox__title");const o=document.createTextNode(e.show.name);return i.appendChild(o),t.appendChild(i),t}function manageDelete(){const e=document.querySelectorAll(".js-removeFav");for(let t of e)t.addEventListener("click",handleClickDeleteFav)}function renderFavouritesSeriesList(){ulFavourites.innerHTML="",storedFavourites=JSON.parse(localStorage.getItem("localStorageFavourites")),console.log(storedFavourites),seriesFavourites=null===storedFavourites?[]:storedFavourites,console.log(seriesFavourites);for(const e of seriesFavourites){const t=renderFavouriteSerie(e);ulFavourites.appendChild(t)}manageDelete(),seriesFavourites.length>0?btnDeleteAll.classList.remove("hidden"):btnDeleteAll.classList.add("hidden")}function imageSrc(e,t){null===e.show.image?t.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"):t.setAttribute("src",e.show.image.medium)}function handleClickFavourites(e){e.preventDefault();const t=e.currentTarget.dataset.idElement;for(const s of seriesList)if(s.show.id===parseInt(t)){const t=seriesFavourites.findIndex(e=>e.show.id===s.show.id);-1!==t?(e.currentTarget.classList.remove("selected"),seriesFavourites.splice(t,1)):(e.currentTarget.classList.add("selected"),seriesFavourites.push(s)),localStorage.setItem("localStorageFavourites",JSON.stringify(seriesFavourites)),renderFavouritesSeriesList(seriesFavourites);break}}function handleClickBtnSearch(e){e.preventDefault();const t=inputText.value;if(""===t)return void alert("Debes ingresar un valor para buscar");fetch("//api.tvmaze.com/search/shows?q=:"+t).then(e=>e.json()).then((function(e){seriesList=e.filter(e=>e.show.name.toLowerCase().includes(t.toLowerCase())),0===seriesList.length?(notFound.classList.remove("hidden"),notFound.innerHTML='<i class="fa-regular fa-circle-xmark"></i> Lo sentimos. No se ha encontrado ninguna serie con ese nombre.'):notFound.classList.add("hidden"),renderSerieList(seriesList)}))}function handleClickDeleteFav(e){console.log(t);const t=e.currentTarget.dataset.idElement,s=seriesFavourites.findIndex(e=>e.show.id===parseInt(t));-1!==s&&(seriesFavourites.splice(s,1),storedFavourites.splice(s,1))}function handleClickBtnDeleteAll(e){e.preventDefault();document.querySelectorAll(".js-serieBox").forEach(e=>{e.classList.remove("selected")}),seriesFavourites=[],storedFavourites=[],localStorage.removeItem("localStorageFavourites"),renderFavouritesSeriesList(seriesFavourites)}btnSearch.addEventListener("click",handleClickBtnSearch),btnDeleteAll.addEventListener("click",handleClickBtnDeleteAll),renderFavouritesSeriesList();